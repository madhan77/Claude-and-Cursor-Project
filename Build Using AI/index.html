<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prototype Template Builder - 100% Free</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            color: #e0e0e0;
            min-height: 100vh;
        }
        header {
            padding: 20px 40px;
            background: rgba(26, 31, 58, 0.9);
            border-bottom: 1px solid rgba(120, 119, 198, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .badge {
            padding: 8px 16px;
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid #10b981;
            border-radius: 20px;
            color: #10b981;
            font-size: 13px;
            font-weight: 600;
        }
        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 30px 40px;
        }
        .hero {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 40px;
        }
        .hero h1 {
            font-size: 48px;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .hero p {
            font-size: 20px;
            color: #a0aec0;
            margin-bottom: 30px;
        }
        .hero .stats {
            display: flex;
            gap: 40px;
            justify-content: center;
            margin-top: 30px;
        }
        .stat {
            text-align: center;
        }
        .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: #10b981;
        }
        .stat-label {
            font-size: 14px;
            color: #718096;
        }
        .workspace {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .mode-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px;
            border-radius: 8px;
        }
        .mode-btn {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(120, 119, 198, 0.3);
            border-radius: 8px;
            color: #e0e0e0;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }
        .mode-btn.active {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            color: #fff;
        }
        .upload-area {
            border: 2px dashed rgba(120, 119, 198, 0.5);
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.2);
        }
        .upload-area:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        .upload-area.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
        }
        .upload-container {
            position: relative;
        }
        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        .upload-text {
            font-size: 16px;
            color: #e0e0e0;
            margin-bottom: 10px;
        }
        .upload-hint {
            font-size: 12px;
            color: #a0aec0;
        }
        .file-input {
            display: none;
        }
        #imagePreview {
            text-align: center;
        }
        .uploaded-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid rgba(120, 119, 198, 0.3);
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .api-key-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }
        .api-key-label {
            font-size: 12px;
            color: #a0aec0;
            margin-bottom: 8px;
            display: block;
        }
        .api-key-input {
            width: 100%;
            padding: 10px 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(120, 119, 198, 0.5);
            border-radius: 8px;
            color: #fff;
            font-size: 13px;
        }
        .api-key-input:focus {
            outline: none;
            border-color: #667eea;
        }
        .api-key-hint {
            font-size: 11px;
            color: #718096;
            margin-top: 5px;
        }
        .template-mode, .upload-mode {
            display: none;
        }
        .template-mode.active, .upload-mode.active {
            display: block;
        }
        .provider-btn {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(120, 119, 198, 0.3);
            border-radius: 8px;
            color: #e0e0e0;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 13px;
            font-weight: 500;
        }
        .provider-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        .provider-btn.active {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            color: #fff;
        }
        .comparison-view {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .comparison-panel {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            border: 2px solid rgba(120, 119, 198, 0.3);
        }
        .comparison-header {
            font-weight: 600;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(120, 119, 198, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .comparison-preview {
            width: 100%;
            height: 400px;
            background: white;
            border-radius: 8px;
            border: none;
        }
        .comparison-code {
            width: 100%;
            height: 400px;
            background: #1e1e1e;
            border: 2px solid rgba(120, 119, 198, 0.5);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #d4d4d4;
            overflow: auto;
            white-space: pre-wrap;
        }
        .panel {
            background: rgba(26, 31, 58, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid rgba(120, 119, 198, 0.2);
            padding: 25px;
        }
        .panel-header {
            font-size: 18px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(120, 119, 198, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .search-box {
            position: relative;
            margin-bottom: 20px;
        }
        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 16px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(120, 119, 198, 0.5);
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
        }
        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }
        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
        }
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }
        .template-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(120, 119, 198, 0.3);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }
        .template-card:hover {
            background: rgba(102, 126, 234, 0.1);
            border-color: #667eea;
            transform: translateY(-3px);
        }
        .template-card.selected {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        .template-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }
        .template-name {
            font-size: 14px;
            font-weight: 600;
            color: #e0e0e0;
            margin-bottom: 5px;
        }
        .template-desc {
            font-size: 11px;
            color: #a0aec0;
        }
        .generate-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tab {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(120, 119, 198, 0.3);
            border-radius: 8px;
            color: #e0e0e0;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        .tab.active {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            color: #fff;
        }
        .preview-frame {
            width: 100%;
            height: 550px;
            background: white;
            border-radius: 8px;
            border: none;
        }
        .code-area {
            width: 100%;
            height: 550px;
            background: #1e1e1e;
            border: 2px solid rgba(120, 119, 198, 0.5);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #d4d4d4;
            overflow: auto;
            white-space: pre-wrap;
        }
        .output-section {
            display: none;
        }
        .output-section.active {
            display: block;
        }
        .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
            transition: all 0.3s;
        }
        .btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        .loading-overlay.show {
            display: flex;
        }
        .loading-content {
            text-align: center;
            background: rgba(26, 31, 58, 0.9);
            padding: 40px;
            border-radius: 16px;
        }
        .checkmark {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #10b981;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 48px;
            animation: scaleIn 0.3s ease;
        }
        @keyframes scaleIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(120, 119, 198, 0.5);
            border-radius: 4px;
        }
        @media (max-width: 1200px) {
            .workspace {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">üé® Prototype Template Builder</div>
        <div class="badge">‚ö° 100% Free ‚Ä¢ No API</div>
    </header>

    <div class="container">
        <div class="hero">
            <h1>Professional Templates, Instant Results</h1>
            <p>Choose from 10 hand-crafted templates. Generate in under 1 second.</p>
            <div class="stats">
                <div class="stat">
                    <div class="stat-number">10</div>
                    <div class="stat-label">Templates</div>
                </div>
                <div class="stat">
                    <div class="stat-number">< 1s</div>
                    <div class="stat-label">Generation Time</div>
                </div>
                <div class="stat">
                    <div class="stat-number">$0</div>
                    <div class="stat-label">Forever Free</div>
                </div>
            </div>
        </div>

        <div class="workspace">
            <div class="panel">
                <div class="panel-header">
                    <span>üìö Input</span>
                    <span class="badge" id="inputBadge" style="font-size: 11px;">Templates</span>
                </div>

                <div class="mode-toggle">
                    <div class="mode-btn active" data-mode="template">üìã Templates</div>
                    <div class="mode-btn" data-mode="upload">üì§ Upload File</div>
                </div>

                <!-- Template Mode -->
                <div class="template-mode active" id="templateMode">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="Search templates...">
                        <span class="search-icon">üîç</span>
                    </div>

                    <div class="template-grid" id="templateGrid">
                    <div class="template-card" data-template="dashboard" data-keywords="dashboard kanban project management tasks">
                        <div class="template-icon">üìä</div>
                        <div class="template-name">Dashboard</div>
                        <div class="template-desc">Project Management</div>
                    </div>
                    
                    <div class="template-card" data-template="login" data-keywords="login auth authentication signin">
                        <div class="template-icon">üîê</div>
                        <div class="template-name">Login Page</div>
                        <div class="template-desc">Modern Auth UI</div>
                    </div>
                    
                    <div class="template-card" data-template="landing" data-keywords="landing hero homepage saas">
                        <div class="template-icon">üöÄ</div>
                        <div class="template-name">Landing Page</div>
                        <div class="template-desc">Hero + CTA</div>
                    </div>
                    
                    <div class="template-card" data-template="pricing" data-keywords="pricing plans subscription tiers">
                        <div class="template-icon">üí∞</div>
                        <div class="template-name">Pricing</div>
                        <div class="template-desc">3-Tier Pricing</div>
                    </div>
                    
                    <div class="template-card" data-template="contact" data-keywords="contact form email message">
                        <div class="template-icon">üìß</div>
                        <div class="template-name">Contact Form</div>
                        <div class="template-desc">Get in Touch</div>
                    </div>
                    
                    <div class="template-card" data-template="portfolio" data-keywords="portfolio projects showcase gallery">
                        <div class="template-icon">üé®</div>
                        <div class="template-name">Portfolio</div>
                        <div class="template-desc">Project Showcase</div>
                    </div>
                    
                    <div class="template-card" data-template="blog" data-keywords="blog articles posts content">
                        <div class="template-icon">üìù</div>
                        <div class="template-name">Blog</div>
                        <div class="template-desc">Article Layout</div>
                    </div>
                    
                    <div class="template-card" data-template="ecommerce" data-keywords="ecommerce shop product store">
                        <div class="template-icon">üõí</div>
                        <div class="template-name">E-commerce</div>
                        <div class="template-desc">Product Page</div>
                    </div>
                    
                    <div class="template-card" data-template="about" data-keywords="about team company profile">
                        <div class="template-icon">üë•</div>
                        <div class="template-name">About/Team</div>
                        <div class="template-desc">Company Info</div>
                    </div>
                    
                    <div class="template-card" data-template="app" data-keywords="app mobile ios android showcase">
                        <div class="template-icon">üì±</div>
                        <div class="template-name">App Landing</div>
                        <div class="template-desc">Mobile App</div>
                    </div>
                    </div>
                </div>

                <!-- Upload Mode -->
                <div class="upload-mode" id="uploadMode">
                    <div class="api-provider-section" style="margin-bottom: 20px;">
                        <label class="api-key-label" style="margin-bottom: 10px; display: block;">ü§ñ AI Provider</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="provider-btn active" data-provider="gemini" id="geminiProviderBtn">
                                üîµ Gemini
                            </button>
                            <button class="provider-btn" data-provider="claude" id="claudeProviderBtn">
                                üü£ Claude
                            </button>
                            <button class="provider-btn" data-provider="both" id="bothProviderBtn">
                                ‚öñÔ∏è Compare Both
                            </button>
                        </div>
                    </div>

                    <div class="api-key-section" id="geminiKeySection">
                        <label class="api-key-label">üîë Gemini API Key</label>
                        <input type="password" class="api-key-input" id="geminiApiKeyInput" placeholder="AIzaSy...">
                        <div class="api-key-hint">
                            Get your key from <a href="https://makersuite.google.com/app/apikey" target="_blank" style="color: #667eea;">Google AI Studio</a>
                            <br>
                            <a href="discover.html" target="_blank" style="color: #667eea; font-size: 11px;">üîç Discover available models</a> |
                            <a href="test.html" target="_blank" style="color: #667eea; font-size: 11px;">üß™ Test your API key</a>
                        </div>
                    </div>

                    <div class="api-key-section" id="claudeKeySection" style="display: none;">
                        <label class="api-key-label">üîë Claude API Key</label>
                        <input type="password" class="api-key-input" id="claudeApiKeyInput" placeholder="sk-ant-...">
                        <div class="api-key-hint">
                            Get your key from <a href="https://console.anthropic.com/" target="_blank" style="color: #667eea;">Anthropic Console</a>
                            <br>
                            <span style="font-size: 11px;">Claude supports vision models for image analysis</span>
                        </div>
                    </div>

                    <div class="upload-container">
                        <div class="upload-area" id="uploadArea">
                            <input type="file" id="fileInput" class="file-input" accept="image/*">
                            <div class="upload-icon">üì§</div>
                            <div class="upload-text">Click to upload or drag & drop</div>
                            <div class="upload-hint">Upload a design/image to generate code</div>
                        </div>
                        <div id="imagePreview" style="display: none;">
                            <img id="uploadedImage" class="uploaded-image" alt="Uploaded image">
                            <button class="btn" id="removeImageBtn" style="margin-top: 10px; width: 100%;">Remove Image</button>
                        </div>
                    </div>
                </div>

                <button class="generate-btn" id="generateBtn">‚ö° Generate Code</button>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <span>üíª Preview</span>
                    <span class="badge" id="statusBadge" style="font-size: 11px;">Ready</span>
                </div>
                
                <div class="tabs">
                    <div class="tab active" data-output="preview">üëÅÔ∏è Preview</div>
                    <div class="tab" data-output="code">üìù Code</div>
                    <div class="tab" data-output="compare" id="compareTab" style="display: none;">‚öñÔ∏è Compare</div>
                </div>

                <div class="output-section active" id="previewSection">
                    <iframe id="previewFrame" class="preview-frame"></iframe>
                </div>

                <div class="output-section" id="codeSection">
                    <div id="codeDisplay" class="code-area">Click a template and generate to see code here...</div>
                </div>

                <div class="output-section" id="compareSection" style="display: none;">
                    <div class="comparison-view" id="comparisonView">
                        <div class="comparison-panel">
                            <div class="comparison-header">
                                <span>üîµ Gemini</span>
                                <span class="badge" style="font-size: 10px;" id="geminiStatus">Not generated</span>
                            </div>
                            <div class="tabs" style="margin-bottom: 10px;">
                                <div class="tab active" data-comparison="preview" data-provider="gemini" style="flex: 1; font-size: 12px; padding: 8px;">Preview</div>
                                <div class="tab" data-comparison="code" data-provider="gemini" style="flex: 1; font-size: 12px; padding: 8px;">Code</div>
                            </div>
                            <iframe id="geminiPreview" class="comparison-preview" style="display: block;"></iframe>
                            <div id="geminiCode" class="comparison-code" style="display: none;"></div>
                        </div>
                        <div class="comparison-panel">
                            <div class="comparison-header">
                                <span>üü£ Claude</span>
                                <span class="badge" style="font-size: 10px;" id="claudeStatus">Not generated</span>
                            </div>
                            <div class="tabs" style="margin-bottom: 10px;">
                                <div class="tab active" data-comparison="preview" data-provider="claude" style="flex: 1; font-size: 12px; padding: 8px;">Preview</div>
                                <div class="tab" data-comparison="code" data-provider="claude" style="flex: 1; font-size: 12px; padding: 8px;">Code</div>
                            </div>
                            <iframe id="claudePreview" class="comparison-preview" style="display: block;"></iframe>
                            <div id="claudeCode" class="comparison-code" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="actions">
                    <button class="btn" id="downloadBtn">üì• Download</button>
                    <button class="btn" id="copyBtn">üìã Copy Code</button>
                    <button class="btn btn-primary" id="openBtn">üîç Open in New Tab</button>
                </div>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="checkmark">‚úì</div>
            <div id="loadingTitle" style="font-size: 24px; color: #fff; font-weight: 600;">Generating Code...</div>
            <div id="loadingDetail" class="status-detail" style="font-size: 14px; color: #a0aec0; margin-top: 10px;">Analyzing image structure...</div>
        </div>
    </div>

    <script>
        // State
        let selectedTemplate = null;
        let generatedCode = '';
        let currentMode = 'template';
        let uploadedImageData = null;
        let currentProvider = 'gemini'; // 'gemini', 'claude', or 'both'
        let geminiCode = '';
        let claudeCode = '';

        // Mode toggle
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                currentMode = this.dataset.mode;
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.template-mode, .upload-mode').forEach(m => m.classList.remove('active'));
                document.getElementById(currentMode + 'Mode').classList.add('active');
                
                document.getElementById('inputBadge').textContent = currentMode === 'template' ? 'Templates' : 'Upload';
                document.getElementById('generateBtn').textContent = currentMode === 'template' ? '‚ö° Generate Template' : '‚ö° Generate Code from Image';
            });
        });

        // Provider toggle
        document.querySelectorAll('.provider-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                currentProvider = this.dataset.provider;
                document.querySelectorAll('.provider-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Show/hide API key sections
                if (currentProvider === 'gemini' || currentProvider === 'both') {
                    document.getElementById('geminiKeySection').style.display = 'block';
                } else {
                    document.getElementById('geminiKeySection').style.display = 'none';
                }
                
                if (currentProvider === 'claude' || currentProvider === 'both') {
                    document.getElementById('claudeKeySection').style.display = 'block';
                } else {
                    document.getElementById('claudeKeySection').style.display = 'none';
                }

                // Show/hide compare tab
                if (currentProvider === 'both') {
                    document.getElementById('compareTab').style.display = 'block';
                } else {
                    document.getElementById('compareTab').style.display = 'none';
                    // Switch to preview tab if compare was active
                    if (document.querySelector('.tab[data-output="compare"]').classList.contains('active')) {
                        document.querySelector('.tab[data-output="preview"]').click();
                    }
                }
            });
        });

        // File upload handling
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const imagePreview = document.getElementById('imagePreview');
        const uploadedImage = document.getElementById('uploadedImage');

        uploadArea.addEventListener('click', () => fileInput.click());

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('Please upload an image file');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                uploadedImageData = e.target.result;
                uploadedImage.src = uploadedImageData;
                // Show image preview and hide upload area
                imagePreview.style.display = 'block';
                uploadArea.style.display = 'none';
                // Update status
                document.getElementById('statusBadge').textContent = 'Image Ready';
            };
            reader.readAsDataURL(file);
        }

        // Remove image button
        document.getElementById('removeImageBtn').addEventListener('click', function() {
            fileInput.value = '';
            uploadedImageData = null;
            // Show upload area and hide image preview
            imagePreview.style.display = 'none';
            uploadArea.style.display = 'block';
            // Reset status
            document.getElementById('statusBadge').textContent = 'Ready';
        });

        // Template selection
        document.querySelectorAll('.template-card').forEach(card => {
            card.addEventListener('click', function() {
                selectedTemplate = this.dataset.template;
                document.querySelectorAll('.template-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                document.getElementById('statusBadge').textContent = `${this.querySelector('.template-name').textContent} Selected`;
            });
        });

        // Search
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const search = e.target.value.toLowerCase();
            document.querySelectorAll('.template-card').forEach(card => {
                const keywords = card.dataset.keywords.toLowerCase();
                const name = card.querySelector('.template-name').textContent.toLowerCase();
                if (keywords.includes(search) || name.includes(search)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = search ? 'none' : 'block';
                }
            });
        });

        // Generate
        document.getElementById('generateBtn').addEventListener('click', async function() {
            if (currentMode === 'template') {
                // Template mode
                if (!selectedTemplate) {
                    alert('Please select a template first!');
                    return;
                }

                this.disabled = true;
                this.textContent = '‚è≥ Generating...';

                // Show loading
                document.getElementById('loadingOverlay').classList.add('show');

                // Simulate brief delay for UX
                setTimeout(() => {
                    if (selectedTemplate === 'dashboard') {
                        // Load from dashboard.html file
                        fetch('dashboard.html')
                            .then(response => response.text())
                            .then(code => {
                                generatedCode = code;
                                displayResult(code);
                                finishGeneration();
                            })
                            .catch(error => {
                                console.error('Error loading dashboard:', error);
                                generatedCode = getTemplateCode(selectedTemplate);
                                displayResult(generatedCode);
                                finishGeneration();
                            });
                    } else {
                        generatedCode = getTemplateCode(selectedTemplate);
                        displayResult(generatedCode);
                        finishGeneration();
                    }
                }, 500);

                function finishGeneration() {
                    setTimeout(() => {
                        document.getElementById('loadingOverlay').classList.remove('show');
                    }, 1000);
                    
                    document.getElementById('generateBtn').disabled = false;
                    document.getElementById('generateBtn').textContent = '‚ö° Generate Template';
                    document.getElementById('statusBadge').textContent = 'Generated!';
                }
            } else {
                // Upload mode - Generate from image
                if (!uploadedImageData) {
                    alert('Please upload an image first!');
                    return;
                }

                // Check API keys based on provider
                const geminiApiKey = document.getElementById('geminiApiKeyInput').value.trim();
                const claudeApiKey = document.getElementById('claudeApiKeyInput').value.trim();

                if (currentProvider === 'gemini' && !geminiApiKey) {
                    alert('Please enter your Gemini API key.\n\nGet your key from: https://makersuite.google.com/app/apikey');
                    return;
                }
                
                if (currentProvider === 'claude' && !claudeApiKey) {
                    alert('Please enter your Claude API key.\n\nGet your key from: https://console.anthropic.com/');
                    return;
                }
                
                if (currentProvider === 'both' && (!geminiApiKey || !claudeApiKey)) {
                    alert('Please enter both API keys to compare.\n\nGemini: https://makersuite.google.com/app/apikey\nClaude: https://console.anthropic.com/');
                    return;
                }

                // Generate based on selected provider
                if (currentProvider === 'both') {
                    generateWithBothProviders(geminiApiKey, claudeApiKey);
                } else if (currentProvider === 'claude') {
                    generateWithClaude(claudeApiKey);
                } else {
                    generateWithGemini(geminiApiKey);
                }
            }
        });

        // Generate with Gemini
        async function generateWithGemini(apiKey) {
            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = true;
            generateBtn.textContent = '‚è≥ Analyzing Image...';

            // Show loading
            const loadingOverlay = document.getElementById('loadingOverlay');
            const loadingContent = loadingOverlay.querySelector('.loading-content');
            loadingOverlay.classList.add('show');
            
            const loadingDetail = document.getElementById('loadingDetail');
            const loadingTitle = document.getElementById('loadingTitle');
            if (loadingTitle) loadingTitle.textContent = 'Generating with Gemini...';
            
            let loadingStep = 0;
            const loadingSteps = [
                'Analyzing image structure...',
                'Identifying layout components...',
                'Extracting colors and styles...',
                'Generating HTML code...',
                'Finalizing...'
            ];
            
            const loadingInterval = setInterval(() => {
                if (loadingStep < loadingSteps.length - 1) {
                    loadingStep++;
                    if (loadingDetail) {
                        loadingDetail.textContent = loadingSteps[loadingStep];
                    }
                }
            }, 2000);

            try {
                await generateGeminiCode(apiKey, loadingInterval, loadingTitle, loadingDetail);
            } catch (error) {
                clearInterval(loadingInterval);
                console.error('Error generating code:', error);
                alert('Error generating code: ' + error.message);
                loadingOverlay.classList.remove('show');
                generateBtn.disabled = false;
                generateBtn.textContent = '‚ö° Generate Code from Image';
            }
        }

        // Generate with Claude
        async function generateWithClaude(apiKey) {
            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = true;
            generateBtn.textContent = '‚è≥ Analyzing Image...';

            const loadingOverlay = document.getElementById('loadingOverlay');
            const loadingContent = loadingOverlay.querySelector('.loading-content');
            loadingOverlay.classList.add('show');
            
            const loadingDetail = document.getElementById('loadingDetail');
            const loadingTitle = document.getElementById('loadingTitle');
            if (loadingTitle) loadingTitle.textContent = 'Generating with Claude...';
            
            let loadingStep = 0;
            const loadingSteps = [
                'Analyzing image structure...',
                'Identifying layout components...',
                'Extracting colors and styles...',
                'Generating HTML code...',
                'Finalizing...'
            ];
            
            const loadingInterval = setInterval(() => {
                if (loadingStep < loadingSteps.length - 1) {
                    loadingStep++;
                    if (loadingDetail) {
                        loadingDetail.textContent = loadingSteps[loadingStep];
                    }
                }
            }, 2000);

            try {
                await generateClaudeCode(apiKey, loadingInterval, loadingTitle, loadingDetail);
            } catch (error) {
                clearInterval(loadingInterval);
                console.error('Error generating code:', error);
                alert('Error generating code: ' + error.message);
                loadingOverlay.classList.remove('show');
                generateBtn.disabled = false;
                generateBtn.textContent = '‚ö° Generate Code from Image';
            }
        }

        // Generate with both providers for comparison
        async function generateWithBothProviders(geminiApiKey, claudeApiKey) {
            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = true;
            generateBtn.textContent = '‚è≥ Generating with Both...';

            const loadingOverlay = document.getElementById('loadingOverlay');
            const loadingContent = loadingOverlay.querySelector('.loading-content');
            loadingOverlay.classList.add('show');
            
            const loadingDetail = document.getElementById('loadingDetail');
            const loadingTitle = document.getElementById('loadingTitle');
            if (loadingTitle) loadingTitle.textContent = 'Generating with Both Providers...';

            try {
                // Update status badges
                document.getElementById('geminiStatus').textContent = 'Generating...';
                document.getElementById('claudeStatus').textContent = 'Generating...';

                // Generate with both in parallel
                const [geminiResult, claudeResult] = await Promise.allSettled([
                    generateGeminiCodeForComparison(geminiApiKey),
                    generateClaudeCodeForComparison(claudeApiKey)
                ]);

                // Handle Gemini result
                if (geminiResult.status === 'fulfilled') {
                    geminiCode = geminiResult.value;
                    displayComparisonResult('gemini', geminiCode);
                    document.getElementById('geminiStatus').textContent = 'Generated';
                    document.getElementById('geminiStatus').style.background = 'rgba(16, 185, 129, 0.2)';
                    document.getElementById('geminiStatus').style.borderColor = '#10b981';
                    document.getElementById('geminiStatus').style.color = '#10b981';
                } else {
                    console.error('Gemini generation failed:', geminiResult.reason);
                    document.getElementById('geminiStatus').textContent = 'Failed';
                    document.getElementById('geminiStatus').style.background = 'rgba(239, 68, 68, 0.2)';
                    document.getElementById('geminiStatus').style.borderColor = '#ef4444';
                    document.getElementById('geminiStatus').style.color = '#ef4444';
                }

                // Handle Claude result
                if (claudeResult.status === 'fulfilled') {
                    claudeCode = claudeResult.value;
                    displayComparisonResult('claude', claudeCode);
                    document.getElementById('claudeStatus').textContent = 'Generated';
                    document.getElementById('claudeStatus').style.background = 'rgba(16, 185, 129, 0.2)';
                    document.getElementById('claudeStatus').style.borderColor = '#10b981';
                    document.getElementById('claudeStatus').style.color = '#10b981';
                } else {
                    console.error('Claude generation failed:', claudeResult.reason);
                    document.getElementById('claudeStatus').textContent = 'Failed';
                    document.getElementById('claudeStatus').style.background = 'rgba(239, 68, 68, 0.2)';
                    document.getElementById('claudeStatus').style.borderColor = '#ef4444';
                    document.getElementById('claudeStatus').style.color = '#ef4444';
                }

                // Switch to compare tab
                document.querySelector('.tab[data-output="compare"]').click();

                loadingOverlay.classList.remove('show');
                generateBtn.disabled = false;
                generateBtn.textContent = '‚ö° Generate Code from Image';

            } catch (error) {
                console.error('Error in comparison:', error);
                loadingOverlay.classList.remove('show');
                generateBtn.disabled = false;
                generateBtn.textContent = '‚ö° Generate Code from Image';
            }
        }

        // Helper function to generate Gemini code (for single use)
        async function generateGeminiCode(apiKey, loadingInterval, loadingTitle, loadingDetail) {
            try {
                // Extract base64 data
                const base64Data = uploadedImageData.split(',')[1];
                const mimeType = uploadedImageData.split(';')[0].split(':')[1];

                    // First, try to discover available models
                    let availableModels = [];
                    try {
                        // Note: Model listing still uses direct API as it's a simple GET request
                        const listUrl = `https://generativelanguage.googleapis.com/v1beta/models?key=${apiKey}`;
                        const listResponse = await fetch(listUrl);
                        const listData = await listResponse.json();
                        
                        if (listData.models) {
                            // Filter models that support generateContent and can handle images
                            availableModels = listData.models
                                .filter(m => 
                                    m.supportedGenerationMethods && 
                                    m.supportedGenerationMethods.includes('generateContent')
                                )
                                .map(m => ({
                                    name: m.name.split('/').pop(),
                                    fullName: m.name
                                }));
                        }
                    } catch (err) {
                        console.log('Could not list models, using fallback list');
                    }

                    // Fallback models to try if ListModels fails or returns no results
                    // Prioritize most accurate models for better matching
                    const fallbackModels = [
                        'gemini-2.5-pro-preview-03-25',  // Most accurate - try first
                        'gemini-1.5-pro',        // Very accurate
                        'gemini-2.0-flash-exp',  // Fast and accurate
                        'gemini-2.5-flash',      // Fast and accurate
                        'gemini-1.5-flash',      // Fast
                        'gemini-pro-vision',
                        'gemini-pro'
                    ];

                    // Combine discovered models with fallbacks (discovered first)
                    const modelsToTry = [
                        ...availableModels.map(m => ({ model: m.name, version: 'v1beta', fullName: m.fullName })),
                        ...fallbackModels.map(m => ({ model: m, version: 'v1beta', fullName: null }))
                    ];

                    // Remove duplicates
                    const uniqueModels = [];
                    const seen = new Set();
                    for (const m of modelsToTry) {
                        if (!seen.has(m.model)) {
                            seen.add(m.model);
                            uniqueModels.push(m);
                        }
                    }

                    let lastError = null;
                    let success = false;
                    let successfulModel = null;

                    for (const { model, version, fullName } of uniqueModels) {
                        try {
                            console.log(`Trying model: ${model} (${version})`);
                            
                            // Build request body with enhanced prompt and generation config
                            const requestBody = {
                                contents: [{
                                    parts: [
                                        { 
                                            text: `You are an expert web developer. Your task is to create an EXACT pixel-perfect replica of the image provided.

CRITICAL: The output HTML must be VISUALLY IDENTICAL to the input image. Every element, color, spacing, and text must match exactly.

STEP 1: CAREFULLY ANALYZE THE IMAGE
- Identify EVERY visual element: headers, sidebars, tables, cards, buttons, icons, text
- Note EXACT colors (use color picker values if possible)
- Note EXACT spacing and layout structure
- Note EXACT typography (font sizes, weights, families)
- Note EXACT positioning of all elements

STEP 2: RECREATE THE EXACT STRUCTURE
- If image has a left sidebar ‚Üí create <aside class="sidebar"> with EXACT width, background color, and ALL menu items
- If image has a top header ‚Üí create <header> with EXACT height, background, and ALL elements
- If image has a table ‚Üí create <table> with EXACT columns, ALL rows, and ALL cell data
- If image has cards ‚Üí create <div class="card"> for EACH card with EXACT styling
- Copy EVERY piece of text EXACTLY as shown in the image

STEP 3: MATCH EXACT STYLING
- Extract EXACT background colors (use hex codes)
- Match EXACT border colors, widths, and radius
- Match EXACT padding and margins (measure from image)
- Match EXACT font sizes, weights, and line heights
- Match EXACT layout (flexbox/grid with exact values)

STEP 4: INCLUDE ALL CONTENT
- Copy ALL text labels, titles, and content EXACTLY
- Include ALL table data with exact values
- Include ALL button text and labels
- Include ALL icons (use emoji or Unicode equivalents)

EXAMPLE - If image shows a Client Projects dashboard with table:
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Projects</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5; /* EXACT color from image */
        }
        .container {
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 250px; /* EXACT width from image */
            background: #1a202c; /* EXACT color from image */
            padding: 20px;
        }
        .main-content {
            flex: 1;
            padding: 30px;
        }
        table {
            width: 100%;
            background: white;
            border-collapse: collapse;
            border-radius: 8px;
            overflow: hidden;
        }
        th {
            background: #f8f9fa;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e9ecef;
        }
        td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
        }
        /* Include ALL styles to match image exactly */
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <!-- Include ALL sidebar content from image -->
        </aside>
        <main class="main-content">
            <h1>Client Projects</h1>
            <table>
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Client email</th>
                        <th>Priority</th>
                        <th>Status</th>
                        <!-- Include ALL column headers from image -->
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Task name from image</td>
                        <td>email@example.com</td>
                        <td>High</td>
                        <td>In Progress</td>
                        <!-- Include ALL table rows with EXACT data from image -->
                    </tr>
                    <!-- Include ALL rows from image -->
                </tbody>
            </table>
        </main>
    </div>
</body>
</html>

CRITICAL: You MUST include the complete HTML structure:
- Start with <!DOCTYPE html>
- Include <html> tag
- Include <head> with <title> and <style> tags
- Include <body> tag with ALL content
- End with </body> and </html>

DO NOT stop after the <style> tag. You MUST continue and include the <body> tag with all HTML content.

FINAL CHECKLIST before returning:
‚úì Does the code start with <!DOCTYPE html>?
‚úì Does it include <html>, <head>, and <body> tags?
‚úì Is the <body> tag populated with ALL visible content from the image?
‚úì Are ALL colors matching the image (backgrounds, text, borders)?
‚úì Is ALL text content copied EXACTLY from the image?
‚úì Are ALL tables, cards, and components included?
‚úì Does the code end with </body></html>?

Return ONLY the complete HTML code including the <body> tag with all content. Make it visually IDENTICAL to the input image.`
                                        },
                                        {
                                            inline_data: {
                                                mime_type: mimeType,
                                                data: base64Data
                                            }
                                        }
                                    ]
                                }],
                                generationConfig: {
                                    temperature: 0.1,  // Lower temperature for more consistent, accurate output
                                    topK: 40,
                                    topP: 0.95,
                                    maxOutputTokens: 16384  // Increased to allow complete HTML documents
                                }
                            };

                            const response = await fetch('https://us-central1-claude-project-10b09.cloudfunctions.net/geminiProxy', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    apiKey: apiKey,
                                    model: model,
                                    contents: requestBody.contents
                                })
                            });

                            const data = await response.json();

                            if (!response.ok) {
                                lastError = new Error(data.error?.message || `Model ${model} not available`);
                                console.log(`Model ${model} failed:`, data.error?.message);
                                continue; // Try next model
                            }

                            if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                                clearInterval(loadingInterval);
                                const loadingTitle = document.getElementById('loadingTitle');
                                const loadingDetail = document.getElementById('loadingDetail');
                                if (loadingTitle) loadingTitle.textContent = 'Code Generated!';
                                if (loadingDetail) loadingDetail.textContent = `Using model: ${model}`;
                                
                                generatedCode = processGeneratedCode(data.candidates[0].content.parts[0].text);
                                
                                console.log(`‚úÖ Success with model: ${model}`);
                                console.log(`Generated code length: ${generatedCode.length} characters`);
                                console.log(`Has DOCTYPE: ${generatedCode.includes('<!DOCTYPE')}`);
                                console.log(`Has body tag: ${generatedCode.includes('<body')}`);
                                
                                displayResult(generatedCode);
                                
                                setTimeout(() => {
                                    document.getElementById('loadingOverlay').classList.remove('show');
                                }, 1500);
                                
                                success = true;
                                successfulModel = model;
                                break; // Success, exit loop
                            }
                        } catch (err) {
                            lastError = err;
                            console.log(`Model ${model} error:`, err.message);
                            continue; // Try next model
                        }
                    }

                    if (!success) {
                        clearInterval(loadingInterval);
                        throw lastError || new Error('All models failed. Please:\n1. Check your API key is valid\n2. Visit discover.html to see available models\n3. Enable Gemini API at console.cloud.google.com');
                    }

                    // Display result
                    const generateBtn = document.getElementById('generateBtn');
                    clearInterval(loadingInterval);
                    if (loadingTitle) loadingTitle.textContent = 'Code Generated!';
                    if (loadingDetail) loadingDetail.textContent = `Using model: ${successfulModel}`;
                    displayResult(generatedCode);
                    
                    setTimeout(() => {
                        document.getElementById('loadingOverlay').classList.remove('show');
                    }, 1500);
                    
                    generateBtn.disabled = false;
                    generateBtn.textContent = '‚ö° Generate Code from Image';
                    document.getElementById('statusBadge').textContent = `Code Generated! (${successfulModel})`;
            } catch (error) {
                throw error;
            }
        }

        // Generate Gemini code for comparison (returns code string)
        async function generateGeminiCodeForComparison(apiKey) {
            const base64Data = uploadedImageData.split(',')[1];
            const mimeType = uploadedImageData.split(';')[0].split(':')[1];

            // Try models in order
            const fallbackModels = [
                'gemini-2.5-pro-preview-03-25',
                'gemini-1.5-pro',
                'gemini-2.0-flash-exp',
                'gemini-2.5-flash',
                'gemini-1.5-flash'
            ];

            for (const model of fallbackModels) {
                try {
                    const response = await fetch('https://us-central1-claude-project-10b09.cloudfunctions.net/geminiProxy', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            apiKey: apiKey,
                            model: model,
                            contents: [{
                                parts: [
                                    { text: getGenerationPrompt() },
                                    { inline_data: { mime_type: mimeType, data: base64Data } }
                                ]
                            }]
                        })
                    });

                    const data = await response.json();
                    if (response.ok && data.candidates && data.candidates[0] && data.candidates[0].content) {
                        return processGeneratedCode(data.candidates[0].content.parts[0].text);
                    }
                } catch (err) {
                    continue;
                }
            }
            throw new Error('All Gemini models failed');
        }

        // Generate Claude code
        async function generateClaudeCode(apiKey, loadingInterval, loadingTitle, loadingDetail) {
            try {
                const base64Data = uploadedImageData.split(',')[1];
                const mimeType = uploadedImageData.split(';')[0].split(':')[1];

                // Convert to base64 URL for Claude API
                const imageUrl = `data:${mimeType};base64,${base64Data}`;

                const response = await fetch('https://us-central1-claude-project-10b09.cloudfunctions.net/claudeProxy', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        apiKey: apiKey,
                        model: 'claude-3-5-sonnet-20241022',
                        max_tokens: 16384,
                        messages: [{
                            role: 'user',
                            content: [
                                {
                                    type: 'image',
                                    source: {
                                        type: 'base64',
                                        media_type: mimeType,
                                        data: base64Data
                                    }
                                },
                                {
                                    type: 'text',
                                    text: getGenerationPrompt()
                                }
                            ]
                        }]
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error?.message || 'Claude API request failed');
                }

                if (data.content && data.content[0] && data.content[0].text) {
                    clearInterval(loadingInterval);
                    if (loadingTitle) loadingTitle.textContent = 'Code Generated!';
                    if (loadingDetail) loadingDetail.textContent = 'Using Claude 3.5 Sonnet';
                    
                    generatedCode = processGeneratedCode(data.content[0].text);
                    displayResult(generatedCode);
                    
                    setTimeout(() => {
                        document.getElementById('loadingOverlay').classList.remove('show');
                    }, 1500);
                    
                    document.getElementById('generateBtn').disabled = false;
                    document.getElementById('generateBtn').textContent = '‚ö° Generate Code from Image';
                    document.getElementById('statusBadge').textContent = 'Code Generated! (Claude)';
                } else {
                    throw new Error('Unexpected Claude API response format');
                }
            } catch (error) {
                clearInterval(loadingInterval);
                throw error;
            }
        }

        // Generate Claude code for comparison (returns code string)
        async function generateClaudeCodeForComparison(apiKey) {
            const base64Data = uploadedImageData.split(',')[1];
            const mimeType = uploadedImageData.split(';')[0].split(':')[1];

            const response = await fetch('https://us-central1-claude-project-10b09.cloudfunctions.net/claudeProxy', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    apiKey: apiKey,
                    model: 'claude-3-5-sonnet-20241022',
                    max_tokens: 16384,
                    messages: [{
                        role: 'user',
                        content: [
                            {
                                type: 'image',
                                source: {
                                    type: 'base64',
                                    media_type: mimeType,
                                    data: base64Data
                                }
                            },
                            {
                                type: 'text',
                                text: getGenerationPrompt()
                            }
                        ]
                    }]
                })
            });

            const data = await response.json();

            if (!response.ok) {
                throw new Error(data.error?.message || 'Claude API request failed');
            }

            if (data.content && data.content[0] && data.content[0].text) {
                return processGeneratedCode(data.content[0].text);
            } else {
                throw new Error('Unexpected Claude API response format');
            }
        }

        // Shared prompt function
        function getGenerationPrompt() {
            return `You are an expert web developer. Your task is to create an EXACT pixel-perfect replica of the image provided.

CRITICAL: The output HTML must be VISUALLY IDENTICAL to the input image. Every element, color, spacing, and text must match exactly.

STEP 1: CAREFULLY ANALYZE THE IMAGE
- Identify EVERY visual element: headers, sidebars, tables, cards, buttons, icons, text
- Note EXACT colors (use color picker values if possible)
- Note EXACT spacing and layout structure
- Note EXACT typography (font sizes, weights, families)
- Note EXACT positioning of all elements

STEP 2: RECREATE THE EXACT STRUCTURE
- If image has a left sidebar ‚Üí create <aside class="sidebar"> with EXACT width, background color, and ALL menu items
- If image has a top header ‚Üí create <header> with EXACT height, background, and ALL elements
- If image has a table ‚Üí create <table> with EXACT columns, ALL rows, and ALL cell data
- If image has cards ‚Üí create <div class="card"> for EACH card with EXACT styling
- Copy EVERY piece of text EXACTLY as shown in the image

STEP 3: MATCH EXACT STYLING
- Extract EXACT background colors (use hex codes)
- Match EXACT border colors, widths, and radius
- Match EXACT padding and margins (measure from image)
- Match EXACT font sizes, weights, and line heights
- Match EXACT layout (flexbox/grid with exact values)

STEP 4: INCLUDE ALL CONTENT
- Copy ALL text labels, titles, and content EXACTLY
- Include ALL table data with exact values
- Include ALL button text and labels
- Include ALL icons (use emoji or Unicode equivalents)

CRITICAL: You MUST include the complete HTML structure:
- Start with <!DOCTYPE html>
- Include <html> tag
- Include <head> with <title> and <style> tags
- Include <body> tag with ALL content
- End with </body> and </html>

DO NOT stop after the <style> tag. You MUST continue and include the <body> tag with all HTML content.

Return ONLY the complete HTML code including the <body> tag with all content. Make it visually IDENTICAL to the input image.`;
        }

        // Process generated code (clean up and validate)
        function processGeneratedCode(code) {
            // Clean up the code (remove markdown code blocks if any)
            code = code.replace(/```html\n?/g, '').replace(/```\n?/g, '').trim();
            
            // Remove any leading text before <!DOCTYPE
            const doctypeIndex = code.indexOf('<!DOCTYPE');
            if (doctypeIndex > 0) {
                code = code.substring(doctypeIndex);
            }
            
            // Check if body tag exists
            const hasBodyTag = code.includes('<body') || code.includes('</body>');
            
            // Try to extract complete HTML document
            let htmlMatch = code.match(/<!DOCTYPE[\s\S]*<\/html>/i);
            if (htmlMatch) {
                code = htmlMatch[0];
            }
            
            // If body tag is missing, add it
            if (!hasBodyTag) {
                const headEndIndex = code.indexOf('</head>');
                if (headEndIndex !== -1) {
                    const beforeBody = code.substring(0, headEndIndex + 7);
                    const afterHead = code.substring(headEndIndex + 7).trim();
                    if (afterHead && !afterHead.startsWith('</html>')) {
                        code = beforeBody + '\n<body>\n' + afterHead + '\n</body>\n</html>';
                    } else {
                        code = beforeBody + '\n<body>\n</body>\n</html>';
                    }
                } else {
                    const styleEndIndex = code.indexOf('</style>');
                    if (styleEndIndex !== -1) {
                        const beforeBody = code.substring(0, styleEndIndex + 8);
                        const afterStyle = code.substring(styleEndIndex + 8).trim();
                        if (afterStyle && !afterStyle.startsWith('</html>') && !afterStyle.startsWith('</head>')) {
                            code = beforeBody + '\n</head>\n<body>\n' + afterStyle + '\n</body>\n</html>';
                        } else {
                            code = beforeBody + '\n</head>\n<body>\n</body>\n</html>';
                        }
                    }
                }
            }
            
            // Final check - ensure we have closing tags
            if (!code.includes('</html>')) {
                code = code + '\n</html>';
            }
            if (!code.includes('</body>') && code.includes('<body')) {
                code = code.replace('</html>', '</body>\n</html>');
            }
            
            return code;
        }

        // Display comparison result
        function displayComparisonResult(provider, code) {
            const previewFrame = document.getElementById(provider + 'Preview');
            const codeDisplay = document.getElementById(provider + 'Code');
            
            // Update code display
            codeDisplay.textContent = code;
            
            // Create blob and set preview iframe
            const blob = new Blob([code], { type: 'text/html' });
            const blobUrl = URL.createObjectURL(blob);
            previewFrame.src = blobUrl;
        }

        function displayResult(code) {
            // Update code display
            document.getElementById('codeDisplay').textContent = code;
            
            // Validate code before displaying
            if (!code || code.trim().length === 0) {
                console.error('Generated code is empty!');
                alert('Error: Generated code is empty. Please try again.');
                return;
            }
            
            // Check if code has actual content (not just CSS) - use same flexible logic as generation
            let bodyMatch = code.match(/<body[^>]*>([\s\S]*?)<\/body>/i);
            
            // If no closing tag found, try to find body opening tag and everything after it
            if (!bodyMatch) {
                const bodyOpenIndex = code.search(/<body[^>]*>/i);
                if (bodyOpenIndex !== -1) {
                    const afterBody = code.substring(bodyOpenIndex);
                    const bodyTagMatch = afterBody.match(/<body[^>]*>/i);
                    if (bodyTagMatch) {
                        const bodyStart = bodyTagMatch[0].length;
                        const bodyContent = afterBody.substring(bodyStart);
                        bodyMatch = { 1: bodyContent };
                    }
                }
            }
            
            if (bodyMatch && bodyMatch[1]) {
                const bodyContent = bodyMatch[1].trim();
                const cleanContent = bodyContent.replace(/<!--[\s\S]*?-->/g, '').replace(/\s+/g, ' ').trim();
                console.log(`üìã Display: Body content length: ${cleanContent.length} chars`);
                if (cleanContent.length < 50) {
                    console.warn('‚ö†Ô∏è Display: Body content seems too short:', cleanContent.length);
                    console.warn('Body content preview:', cleanContent.substring(0, 200));
                } else {
                    console.log(`‚úÖ Display: Body has substantial content`);
                }
            } else {
                // Check if body tag exists at all
                if (code.includes('<body')) {
                    console.warn('‚ö†Ô∏è Display: Body tag found but content extraction failed - code may still be valid');
                } else {
                    console.warn('‚ö†Ô∏è Display: Could not find body tag in code');
                }
            }
            
            // Create blob and set preview iframe
            try {
                const blob = new Blob([code], { type: 'text/html' });
                const blobUrl = URL.createObjectURL(blob);
                
                // Clear previous blob URL to prevent memory leaks
                const previewFrame = document.getElementById('previewFrame');
                if (previewFrame.src && previewFrame.src.startsWith('blob:')) {
                    URL.revokeObjectURL(previewFrame.src);
                }
                
                // Add load event listener to verify iframe loaded
                previewFrame.onload = function() {
                    try {
                        const iframeDoc = previewFrame.contentDocument || previewFrame.contentWindow.document;
                        const iframeBody = iframeDoc.body;
                        if (iframeBody) {
                            const visibleElements = iframeBody.querySelectorAll('*:not(script):not(style)');
                            const textContent = iframeBody.textContent || iframeBody.innerText || '';
                            console.log(`‚úÖ Iframe loaded: ${visibleElements.length} elements, ${textContent.trim().length} chars of text`);
                            if (textContent.trim().length < 50) {
                                console.warn('‚ö†Ô∏è Iframe body has very little text content - layout might not be rendering');
                            }
                        } else {
                            console.warn('‚ö†Ô∏è Iframe body not accessible');
                        }
                    } catch (e) {
                        console.warn('‚ö†Ô∏è Cannot access iframe content (CORS):', e.message);
                    }
                };
                
                previewFrame.src = blobUrl;
                
                // Switch to preview tab automatically
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.querySelectorAll('.output-section').forEach(s => s.classList.remove('active'));
                document.getElementById('previewSection').classList.add('active');
                
                // Store generated code globally
                generatedCode = code;
                
                console.log('‚úÖ Preview iframe updated with generated code');
            } catch (error) {
                console.error('‚ùå Error displaying result:', error);
                alert('Error displaying preview. Check the Code tab to see the generated HTML.');
            }
        }

        // Output tabs
        document.querySelectorAll('.tab[data-output]').forEach(tab => {
            tab.addEventListener('click', function() {
                const outputType = this.dataset.output;
                document.querySelectorAll('.tab[data-output]').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.output-section').forEach(s => s.classList.remove('active'));
                document.getElementById(outputType + 'Section').classList.add('active');
            });
        });

        // Comparison tabs (within comparison panels)
        document.querySelectorAll('.tab[data-comparison]').forEach(tab => {
            tab.addEventListener('click', function() {
                const provider = this.dataset.provider;
                const comparisonType = this.dataset.comparison;
                
                // Remove active from all tabs in this provider's panel
                document.querySelectorAll(`.tab[data-provider="${provider}"]`).forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Show/hide preview and code for this provider
                const preview = document.getElementById(provider + 'Preview');
                const code = document.getElementById(provider + 'Code');
                
                if (comparisonType === 'preview') {
                    preview.style.display = 'block';
                    code.style.display = 'none';
                } else {
                    preview.style.display = 'none';
                    code.style.display = 'block';
                }
            });
        });

        // Actions
        document.getElementById('downloadBtn').addEventListener('click', function() {
            if (!generatedCode) return alert('Generate a template first!');
            const blob = new Blob([generatedCode], { type: 'text/html' });
            const link = document.createElement('a');
            link.download = `${selectedTemplate || 'template'}.html`;
            link.href = URL.createObjectURL(blob);
            link.click();
            alert('‚úÖ Downloaded!');
        });

        document.getElementById('copyBtn').addEventListener('click', function() {
            if (!generatedCode) return alert('Generate a template first!');
            navigator.clipboard.writeText(generatedCode);
            alert('‚úÖ Code copied to clipboard!');
        });

        document.getElementById('openBtn').addEventListener('click', function() {
            if (!generatedCode) return alert('Generate a template first!');
            const blob = new Blob([generatedCode], { type: 'text/html' });
            window.open(URL.createObjectURL(blob), '_blank');
        });

        // Template code function (will be populated with actual templates)
        function getTemplateCode(templateName) {
            const templates = {
                login: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .login-container {
            background: white;
            border-radius: 20px;
            padding: 50px 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        h1 { font-size: 32px; margin-bottom: 10px; color: #1a202c; }
        p { color: #718096; margin-bottom: 30px; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500; }
        input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        input:focus { outline: none; border-color: #667eea; }
        .forgot { text-align: right; margin-bottom: 20px; }
        .forgot a { color: #667eea; text-decoration: none; font-size: 14px; }
        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        button:hover { transform: translateY(-2px); }
        .signup { text-align: center; margin-top: 20px; color: #718096; }
        .signup a { color: #667eea; text-decoration: none; font-weight: 600; }
    </style>
</head>
<body>
    <div class="login-container">
        <h1>Welcome Back</h1>
        <p>Please login to your account</p>
        <form onsubmit="event.preventDefault(); alert('Login functionality would go here!');">
            <div class="input-group">
                <label>Email</label>
                <input type="email" placeholder="your@email.com" required>
            </div>
            <div class="input-group">
                <label>Password</label>
                <input type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
            </div>
            <div class="forgot">
                <a href="#" onclick="alert('Password reset would go here!'); return false;">Forgot password?</a>
            </div>
            <button type="submit">Sign In</button>
        </form>
        <div class="signup">
            Don't have an account? <a href="#" onclick="alert('Sign up page would go here!'); return false;">Sign up</a>
        </div>
    </div>
</body>
</html>`,

                landing: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Landing Page</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; }
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 100px 20px;
            text-align: center;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        h1 { font-size: 56px; margin-bottom: 20px; font-weight: 700; }
        p { font-size: 20px; margin-bottom: 40px; opacity: 0.9; max-width: 600px; }
        .cta-btn {
            padding: 16px 40px;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .cta-btn:hover { transform: translateY(-3px); }
        .features {
            display: flex;
            gap: 40px;
            margin-top: 60px;
        }
        .feature {
            text-align: center;
        }
        .feature-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        @media (max-width: 768px) {
            h1 { font-size: 36px; }
            .features { flex-direction: column; gap: 30px; }
        }
    </style>
</head>
<body>
    <div class="hero">
        <h1>Build Amazing Products</h1>
        <p>The fastest way to create prototypes and ship features. Start building today.</p>
        <button class="cta-btn" onclick="alert('Get started action would go here!')">Get Started Free</button>
        <div class="features">
            <div class="feature">
                <div class="feature-icon">‚ö°</div>
                <div>Lightning Fast</div>
            </div>
            <div class="feature">
                <div class="feature-icon">üé®</div>
                <div>Beautiful Design</div>
            </div>
            <div class="feature">
                <div class="feature-icon">üöÄ</div>
                <div>Easy to Use</div>
            </div>
        </div>
    </div>
</body>
</html>`,

                pricing: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pricing</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #f7fafc;
            padding: 50px 20px;
        }
        h1 { text-align: center; font-size: 48px; margin-bottom: 50px; }
        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            max-width: 1000px;
            margin: 0 auto;
        }
        .price-card {
            background: white;
            padding: 40px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        .price-card:hover { transform: translateY(-5px); }
        .price-card.featured {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1.05);
        }
        .plan-name { font-size: 24px; font-weight: 600; margin-bottom: 10px; }
        .price { font-size: 48px; font-weight: 700; margin: 20px 0; }
        .price span { font-size: 20px; }
        ul { list-style: none; margin: 30px 0; text-align: left; }
        li { padding: 10px 0; }
        li:before { content: "‚úì "; color: #10b981; font-weight: bold; }
        button {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }
        .featured button { background: white; color: #667eea; }
    </style>
</head>
<body>
    <h1>Simple Pricing</h1>
    <div class="pricing-grid">
        <div class="price-card">
            <div class="plan-name">Starter</div>
            <div class="price">$9<span>/mo</span></div>
            <ul>
                <li>10 Projects</li>
                <li>Basic Support</li>
                <li>1 User</li>
            </ul>
            <button onclick="alert('Subscription would start here!')">Get Started</button>
        </div>
        <div class="price-card featured">
            <div class="plan-name">Pro</div>
            <div class="price">$29<span>/mo</span></div>
            <ul>
                <li>Unlimited Projects</li>
                <li>Priority Support</li>
                <li>5 Users</li>
                <li>Advanced Features</li>
            </ul>
            <button onclick="alert('Subscription would start here!')">Get Started</button>
        </div>
        <div class="price-card">
            <div class="plan-name">Enterprise</div>
            <div class="price">$99<span>/mo</span></div>
            <ul>
                <li>Everything in Pro</li>
                <li>Dedicated Support</li>
                <li>Unlimited Users</li>
                <li>Custom Integration</li>
            </ul>
            <button onclick="alert('Contact sales would go here!')">Contact Sales</button>
        </div>
    </div>
</body>
</html>`,

                contact: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Us</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .contact-container {
            background: white;
            border-radius: 20px;
            padding: 50px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        h1 { font-size: 36px; margin-bottom: 10px; }
        p { color: #718096; margin-bottom: 30px; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 500; }
        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
        }
        textarea { min-height: 120px; resize: vertical; font-family: inherit; }
        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="contact-container">
        <h1>Get in Touch</h1>
        <p>We'd love to hear from you</p>
        <form onsubmit="event.preventDefault(); alert('Message sent! (Demo)');">
            <div class="input-group">
                <label>Name</label>
                <input type="text" placeholder="Your name" required>
            </div>
            <div class="input-group">
                <label>Email</label>
                <input type="email" placeholder="your@email.com" required>
            </div>
            <div class="input-group">
                <label>Message</label>
                <textarea placeholder="Your message..." required></textarea>
            </div>
            <button type="submit">Send Message</button>
        </form>
    </div>
</body>
</html>`,

                portfolio: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; }
        header {
            background: #1a202c;
            color: white;
            padding: 60px 20px;
            text-align: center;
        }
        h1 { font-size: 48px; margin-bottom: 10px; }
        .subtitle { font-size: 20px; opacity: 0.8; }
        .projects {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            padding: 50px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .project-card {
            background: #f7fafc;
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s;
            cursor: pointer;
        }
        .project-card:hover { transform: translateY(-5px); }
        .project-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }
        .project-content { padding: 20px; }
        .project-title { font-size: 20px; font-weight: 600; margin-bottom: 10px; }
        .project-desc { color: #718096; }
    </style>
</head>
<body>
    <header>
        <h1>John Doe</h1>
        <p class="subtitle">Creative Designer & Developer</p>
    </header>
    <div class="projects">
        <div class="project-card" onclick="alert('Project details would show here')">
            <div class="project-image">üé®</div>
            <div class="project-content">
                <div class="project-title">Project One</div>
                <p class="project-desc">A beautiful web application</p>
            </div>
        </div>
        <div class="project-card" onclick="alert('Project details would show here')">
            <div class="project-image">üì±</div>
            <div class="project-content">
                <div class="project-title">Project Two</div>
                <p class="project-desc">Mobile app design</p>
            </div>
        </div>
        <div class="project-card" onclick="alert('Project details would show here')">
            <div class="project-image">üöÄ</div>
            <div class="project-content">
                <div class="project-title">Project Three</div>
                <p class="project-desc">Brand identity work</p>
            </div>
        </div>
    </div>
</body>
</html>`,

                blog: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #f7fafc;
        }
        header {
            background: white;
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
            text-align: center;
        }
        h1 { font-size: 36px; }
        .container { max-width: 800px; margin: 50px auto; padding: 0 20px; }
        .post {
            background: white;
            padding: 40px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .post:hover { transform: translateY(-3px); }
        .post-title { font-size: 28px; margin-bottom: 10px; }
        .post-meta { color: #718096; margin-bottom: 20px; }
        .post-content { line-height: 1.6; color: #4a5568; }
    </style>
</head>
<body>
    <header>
        <h1>My Blog</h1>
    </header>
    <div class="container">
        <div class="post" onclick="alert('Full article would open here')">
            <h2 class="post-title">Getting Started with Web Development</h2>
            <div class="post-meta">Posted on January 15, 2024 ‚Ä¢ 5 min read</div>
            <p class="post-content">Learn the fundamentals of modern web development and start building amazing websites today...</p>
        </div>
        <div class="post" onclick="alert('Full article would open here')">
            <h2 class="post-title">Design Best Practices</h2>
            <div class="post-meta">Posted on January 10, 2024 ‚Ä¢ 7 min read</div>
            <p class="post-content">Discover the principles of great design and how to apply them to your projects...</p>
        </div>
        <div class="post" onclick="alert('Full article would open here')">
            <h2 class="post-title">Building Scalable Applications</h2>
            <div class="post-meta">Posted on January 5, 2024 ‚Ä¢ 10 min read</div>
            <p class="post-content">Tips and techniques for building applications that can handle growth and scale...</p>
        </div>
    </div>
</body>
</html>`,

                ecommerce: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Page</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            max-width: 1200px;
            margin: 50px auto;
            padding: 0 20px;
        }
        .product-image {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 120px;
        }
        .product-info h1 { font-size: 36px; margin-bottom: 10px; }
        .price { font-size: 32px; color: #667eea; font-weight: 700; margin: 20px 0; }
        .description { color: #718096; line-height: 1.6; margin-bottom: 30px; }
        .size-selector { margin-bottom: 20px; }
        .size-selector label { display: block; margin-bottom: 10px; font-weight: 500; }
        .sizes { display: flex; gap: 10px; }
        .size-btn {
            padding: 10px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
        }
        .size-btn.active { border-color: #667eea; background: #f0f4ff; }
        .buy-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
        }
        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="product-image">üé®</div>
        <div class="product-info">
            <h1>Premium Product</h1>
            <div class="price">$99.99</div>
            <p class="description">
                Experience luxury and quality with our premium product. 
                Crafted with attention to detail and designed for excellence.
            </p>
            <div class="size-selector">
                <label>Select Size</label>
                <div class="sizes">
                    <button class="size-btn" onclick="document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active')); this.classList.add('active');">S</button>
                    <button class="size-btn active" onclick="document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active')); this.classList.add('active');">M</button>
                    <button class="size-btn" onclick="document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active')); this.classList.add('active');">L</button>
                    <button class="size-btn" onclick="document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active')); this.classList.add('active');">XL</button>
                </div>
            </div>
            <button class="buy-btn" onclick="alert('Added to cart! (Demo)')">Add to Cart</button>
        </div>
    </div>
</body>
</html>`,

                about: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About Us</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; }
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 80px 20px;
            text-align: center;
        }
        h1 { font-size: 48px; margin-bottom: 20px; }
        .hero p { font-size: 20px; opacity: 0.9; max-width: 600px; margin: 0 auto; }
        .team {
            max-width: 1200px;
            margin: 80px auto;
            padding: 0 20px;
        }
        .team h2 { text-align: center; font-size: 36px; margin-bottom: 50px; }
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }
        .team-member {
            text-align: center;
        }
        .member-photo {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
        }
        .member-name { font-size: 20px; font-weight: 600; margin-bottom: 5px; }
        .member-role { color: #718096; }
    </style>
</head>
<body>
    <div class="hero">
        <h1>About Our Company</h1>
        <p>We're a team of passionate individuals building amazing products that make a difference.</p>
    </div>
    <div class="team">
        <h2>Meet Our Team</h2>
        <div class="team-grid">
            <div class="team-member">
                <div class="member-photo">üë®</div>
                <div class="member-name">John Doe</div>
                <div class="member-role">CEO & Founder</div>
            </div>
            <div class="team-member">
                <div class="member-photo">üë©</div>
                <div class="member-name">Jane Smith</div>
                <div class="member-role">Lead Designer</div>
            </div>
            <div class="team-member">
                <div class="member-photo">üë®</div>
                <div class="member-name">Mike Johnson</div>
                <div class="member-role">Lead Developer</div>
            </div>
            <div class="team-member">
                <div class="member-photo">üë©</div>
                <div class="member-name">Sarah Williams</div>
                <div class="member-role">Marketing Director</div>
            </div>
        </div>
    </div>
</body>
</html>`,

                app: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile App Landing</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; }
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 80px 20px;
            text-align: center;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .phone-mockup {
            width: 250px;
            height: 500px;
            background: white;
            border-radius: 30px;
            margin: 40px auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
        }
        h1 { font-size: 48px; margin-bottom: 20px; }
        p { font-size: 20px; margin-bottom: 30px; opacity: 0.9; }
        .download-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
        }
        .store-btn {
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .store-btn:hover { background: rgba(255, 255, 255, 0.3); }
    </style>
</head>
<body>
    <div class="hero">
        <h1>Amazing Mobile App</h1>
        <p>Download now and experience the future</p>
        <div class="phone-mockup">üì±</div>
        <div class="download-buttons">
            <button class="store-btn" onclick="alert('App Store download would start')">
                üçé App Store
            </button>
            <button class="store-btn" onclick="alert('Play Store download would start')">
                ü§ñ Play Store
            </button>
        </div>
    </div>
</body>
</html>`
            };

            return templates[templateName] || `<!DOCTYPE html><html><head><title>${templateName}</title></head><body><h1>${templateName} Template</h1><p>Template code for ${templateName}</p></body></html>`;
        }

        console.log('‚úÖ Template Builder loaded - 10 templates ready!');
    </script>
</body>
</html>
